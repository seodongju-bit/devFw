<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
   <mapper namespace="mapper.active">
	<resultMap id="couResult" type="activeVO">
		<result property="co_number" column="co_number" />
        <result property="co_name" column="co_name" />
        <result property="co_enddate" column="co_enddate" />
        <result property="co_stdate" column="co_stdate" />
        <result property="co_sale" column="co_sale" />
        <result property="co_percent" column="co_percent" />
        <result property="mem_id" column="mem_id" />
	</resultMap> 
	
	<resultMap id="pointResult" type="activeVO">
		<result property="mem_no" column="mem_no" />
        <result property="point_number" column="point_number" />
        <result property="point_date" column="point_date" />
        <result property="point_usedate" column="point_usedate" />
        <result property="point_usemoney" column="point_usemoney" />
        <result property="order_number" column="order_number" />
        <result property="point_content" column="point_content" />
        <result property="mem_id" column="mem_id" />
	</resultMap> 
	
	<select id="selectAllCouponList" resultMap="couResult">
      <![CDATA[
         select 
         mc.co_number, 
         c.co_name, 
         to_char(c.co_enddate,'YYYY-MM-DD') co_enddate, 
         to_char(c.co_stdate,'YYYY-MM-DD') co_stdate,
         c.co_sale, 
         c.co_percent
		 from coupon c, mycoupon mc
		 where c.co_number = mc.co_number
		 and mem_id = #{p_id}	
      ]]>
	</select>
	  
	<select id="selectAllPointlist" resultMap="pointResult" parameterType="java.util.Map">
      <![CDATA[
         SELECT * 
         FROM pointuse
         WHERE mem_id=#{mem_id}
         
       ]]>
          
        <choose>
        	<when test="start != '' and end !='' and date != ''"> 
        		AND ${date} between to_date('${start}', 'YYYY-MM-DD') 
       			AND  to_date('${end}', 'YYYY-MM-DD')+0.9999
    		</when>
		</choose>
		
	</select>
	
	</mapper>